---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data
```{r loading the data, echo = TRUE}
activity <- unzip("./activity.zip")
actData <- read.csv(activity, sep = ",")
str(actData)
```

```{r Process/transform the data into a format suitable for analysis}
actData["meanSteps_allDays"] = tapply(actData$steps, actData$interval, mean, na.rm = TRUE)
```


## What is mean total number of steps taken per day?
```{r Make a histogram of the total number of steps taken each day, echo = TRUE, message = FALSE, warning = FALSE}
library(ggplot2)
ggplot(data = actData, aes(x = steps))+
        geom_histogram()
```
![](https://github.com/younglogos/RepData_PeerAssessment1/blob/master/figure/histogram1.png)

```{r calculate and report the mean and median total number of steps taken per day, echo = TRUE}
meanTotalStep <- with(actData, mean(steps, na.rm = TRUE))
medianTotalStep <- with(actData, median(steps, na.rm = TRUE))
print(c(paste("mean total number of steps:", meanTotalStep), paste("median total number of steps:", medianTotalStep)))
```


## What is the average daily activity pattern?
```{r make a time series plot of the 5-minute interval and the average number of steps taken averaged across all days, echo = TRUE}
ggplot(data = actData, aes(x = interval, y = meanSteps_allDays))+
        geom_line()+
        labs(y = "average steps across all days")
```
![ ](https://github.com/younglogos/RepData_PeerAssessment1/blob/master/figure/time_series1.png)

```{r which 5-minute interval(on average across all the days)contains the maximum number of steps, echo = TRUE}
interval_maxSteps <- unique(actData$interval[which(actData$meanSteps_allDays == max(actData$meanSteps_allDays))])
print(paste("interval with the max steps averaged across all days:",interval_maxSteps))
```

## Imputing missing values
```{r Calculate and report the total number of missing values in the dataset, echo = TRUE}
totalMiss <- sum(is.na(actData))
print(paste("total number of missing values:", totalMiss))
```

```{r devise a strategy for filling in all of the missing values in the dataset and create a new dataset that is equal to the original dataset but with the missing data filled in, echo = TRUE}
fillData <- actData
missIn <- which(is.na(actData$steps))
fillData$steps[missIn] <- fillData$meanSteps_allDays[missIn]
str(fillData)
```

```{r make a histogram of the total number of steps taken each day, echo = TRUE, message = FALSE}
ggplot(data = fillData, aes(x = steps))+
        geom_histogram()
```
![](https://github.com/younglogos/RepData_PeerAssessment1/blob/master/figure/histogram2.png)

```{r calculate the mean and median total number of steps, echo = TRUE}
meanFillTotalStep <- with(fillData, mean(steps, na.rm = TRUE))
medianFillTotalStep <- with(fillData, median(steps, na.rm = TRUE))
print(c(paste("mean total number of steps after filling in missing values:", meanFillTotalStep), paste("median total number of steps after filling in missing values:", medianFillTotalStep)))
```

There is no significant difference on mean and median compared with first part of assignment. It indicated that there was little impact of imputing missing data.


## Are there differences in activity patterns between weekdays and weekends?
```{r Create a new factor variable in the dataset with two levels "weekday" and "weekend", echo = TRUE}
fillData["week"] <- weekdays(as.Date(fillData$date))
fillData$week[fillData$week != "星期六" & fillData$week != "星期日"] <- "weekday"
fillData$week[fillData$week == "星期六" | fillData$week == "星期日"] <- "weekend"
fillData$week <- as.factor(fillData$week)
str(fillData$week)
```
```{r make a time series plot of the the average number of steps averaged across all weekday days or weekend days, echo = TRUE}
ggplot(data = subset(fillData), aes(x = interval, y = meanSteps_allDays))+
  geom_line()+
  facet_grid(.~week)+
  labs(y = "average steps across all weekdays or weekends")
```
![](https://github.com/younglogos/RepData_PeerAssessment1/blob/master/figure/time_series2.png)